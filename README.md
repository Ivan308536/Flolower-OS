# Flolower-OS: Руководство по сборке и эксплуатации

## Описание проекта

Flolower-OS — это операционная система, разработанная для архитектуры x86-x64 (x64). Система функционирует в 64-битном защищенном режиме и предоставляет пользователю текстовый интерфейс (шелл).

**Основные характеристики:**

* **Загрузчик:** Совместим со спецификацией Multiboot для корректной передачи управления от GRUB к ядру.
* **Видеовывод:** Прямая запись в текстовый буфер VGA по адресу `0xB8000`. Поддерживается прокрутка экрана (scroll) и очистка терминала.
* **Ввод:** Обработка скан-кодов клавиатуры методом опроса (polling) портов ввода-вывода.
* **Интерфейс:** Командная строка с поддержкой команд `help`, `clear` и `info`.

## Системные требования

Для сборки проекта в среде Linux или на Windows с помощью WSL требуются следующие компоненты:

* **GCC и Binutils:** Для компиляции C и ассемблирования кода. Обязательна поддержка 64-битной архитектуры (пакет `gcc-multilib` на 64-битных системах).
* **GRUB:** Утилиты `grub-pc-bin` и `grub-common`.
* **Xorriso:** Для формирования загрузочного ISO-образа.

## Сборка и запуск

Все этапы сборки автоматизированы через `Makefile`.

1. **Создание образа:**
В корневой директории проекта выполните команду:
```bash
make
```

В результате будут созданы объектные файлы, бинарный файл ядра `fos.bin` и итоговый образ `flolower-os.iso`.

2. **Запуск в эмуляторе:**
Используйте команду:
```bash
qemu-system-x86_x64 -cdrom flolower-os.iso
```


3. **Очистка проекта:**
Для удаления временных файлов сборки и готовых образов выполните:
```bash
make clean
```

## Возможные ошибки и их устранение

### Ошибка: `grub-mkrescue: command not found`

Это означает отсутствие утилит для создания ISO-образов.

* **Решение:** Установите пакеты `grub-common` и `xorriso`. Если команда называется `grub2-mkrescue`, необходимо внести соответствующие правки в `Makefile`.

### Ошибка: `xorriso: ... libisoburn: failure`

Ошибка возникает при отсутствии прав доступа или недостаточном дисковом пространстве.

* **Решение:** Убедитесь, что у вас есть права на запись в текущую директорию и установлен пакет `libisoburn1`.

### Ошибка линковки (Incompatible architecture)

Если возникает сообщение о несовместимости архитектур (i386 и x86-64).

* **Решение:** Убедитесь, что в `Makefile` присутствуют флаги `-m elf_i386` для линковщика и `-m32` для компилятора.

## Структура файлов

* `b.s` — Точка входа в систему, настройка стека и вызов функции `kernel_main`.
* `kernel.c` — Реализация драйвера терминала, логики командной строки и системных функций.
* `linker.ld` — Скрипт линковщика, определяющий адрес загрузки ядра (1 МБ) и порядок следования секций в памяти.
* `Makefile` — Конфигурация сборки и параметры компиляции.
